<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        .original { background: #f5f5f5; padding: 10px; margin: 10px 0; }
        .rendered { background: #e8f4f8; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Markdown Rendering Test</h1>
    
    <div class="test-section">
        <h2>Test 1: Marked.js</h2>
        <div class="original">
            <strong>Original:</strong>
            <pre>The addition of the O0350 Patient's COVID Vaccination is Up to Date item is associated with the COVID Vaccine quality measure (QM) and will be used in quality measure scoring and reporting for home health agencies (Appendix D). ### Details: * **O0350 Patient's COVID Vaccination is Up to Date:** This new item is associated with the COVID Vaccine quality measure (QM) finalized in the Calendar Year (CY) 2024 Home Health (HH) Prospective Payment System Final Rule (CMS-1780-F) (Section 1.4, Appendix D).</pre>
        </div>
        <div class="rendered" id="marked-test">
            <strong>Rendered with Marked.js:</strong>
            <div id="marked-output"></div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Test 2: Fallback Parser</h2>
        <div class="original">
            <strong>Original:</strong>
            <pre>The addition of the O0350 Patient's COVID Vaccination is Up to Date item is associated with the COVID Vaccine quality measure (QM) and will be used in quality measure scoring and reporting for home health agencies (Appendix D). ### Details: * **O0350 Patient's COVID Vaccination is Up to Date:** This new item is associated with the COVID Vaccine quality measure (QM) finalized in the Calendar Year (CY) 2024 Home Health (HH) Prospective Payment System Final Rule (CMS-1780-F) (Section 1.4, Appendix D).</pre>
        </div>
        <div class="rendered" id="fallback-test">
            <strong>Rendered with Fallback Parser:</strong>
            <div id="fallback-output"></div>
        </div>
    </div>

    <!-- Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked@11.0.0/marked.min.js"></script>
    
    <!-- Fallback markdown parser -->
    <script>
        window.simpleMarkdown = {
            parse: function(text) {
                let html = text;
                
                // Headers
                html = html.replace(/### (.*$)/gim, '<h3>$1</h3>');
                html = html.replace(/## (.*$)/gim, '<h2>$1</h2>');
                html = html.replace(/# (.*$)/gim, '<h1>$1</h1>');
                
                // Bold text
                html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                
                // Italic text
                html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');
                
                // Inline code
                html = html.replace(/`(.*?)`/g, '<code>$1</code>');
                
                // Lists - handle both * and - bullets
                html = html.replace(/^\* (.*$)/gim, '<li>$1</li>');
                html = html.replace(/^- (.*$)/gim, '<li>$1</li>');
                
                // Wrap consecutive list items in ul tags
                html = html.replace(/(<li>.*<\/li>)(\s*<li>.*<\/li>)*/g, function(match) {
                    return '<ul>' + match + '</ul>';
                });
                
                // Line breaks
                html = html.replace(/\n/g, '<br>');
                
                return html;
            }
        };
    </script>
    
    <script>
        const testText = `The addition of the O0350 Patient's COVID Vaccination is Up to Date item is associated with the COVID Vaccine quality measure (QM) and will be used in quality measure scoring and reporting for home health agencies (Appendix D). ### Details: * **O0350 Patient's COVID Vaccination is Up to Date:** This new item is associated with the COVID Vaccine quality measure (QM) finalized in the Calendar Year (CY) 2024 Home Health (HH) Prospective Payment System Final Rule (CMS-1780-F) (Section 1.4, Appendix D).`;
        
        // Test marked.js
        if (typeof marked !== 'undefined') {
            document.getElementById('marked-output').innerHTML = marked.parse(testText);
            console.log('✅ Marked.js test successful');
        } else {
            document.getElementById('marked-output').innerHTML = '<em>Marked.js not loaded</em>';
            console.log('❌ Marked.js not available');
        }
        
        // Test fallback parser
        if (typeof window.simpleMarkdown !== 'undefined') {
            document.getElementById('fallback-output').innerHTML = window.simpleMarkdown.parse(testText);
            console.log('✅ Fallback parser test successful');
        } else {
            document.getElementById('fallback-output').innerHTML = '<em>Fallback parser not available</em>';
            console.log('❌ Fallback parser not available');
        }
    </script>
</body>
</html>
